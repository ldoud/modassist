<?xml version="1.0" encoding="UTF-8"?>
<solver>
    <!--<environmentMode>FAST_ASSERT</environmentMode>-->

    <!-- Domain model configuration -->
    <scanAnnotatedClasses>
        <packageInclude>com.github.ldoud.modassist.planning</packageInclude>
    </scanAnnotatedClasses>

    <scoreDirectorFactory>
        <easyScoreCalculatorClass>com.github.ldoud.modassist.planning.EasySpeedScoreCalculator</easyScoreCalculatorClass>
        <!--<scoreDrl>org/optaplanner/examples/cloudbalancing/solver/cloudBalancingScoreRules.drl</scoreDrl>-->
    </scoreDirectorFactory>

    <!-- Optimization algorithms configuration -->
    <termination>
        <minutesSpentLimit>5</minutesSpentLimit>
    </termination>

    <constructionHeuristic>
        <constructionHeuristicType>STRONGEST_FIT</constructionHeuristicType>
        <changeMoveSelector>
            <valueSelector variableName="transmitter"/>
        </changeMoveSelector>
        <changeMoveSelector>
            <valueSelector variableName="receiver"/>
        </changeMoveSelector>
        <changeMoveSelector>
            <valueSelector variableName="processor"/>
        </changeMoveSelector>
        <changeMoveSelector>
            <valueSelector variableName="holoArray"/>
        </changeMoveSelector>
        <changeMoveSelector>
            <valueSelector variableName="dataBus"/>
        </changeMoveSelector>
        <changeMoveSelector>
            <valueSelector variableName="multiplexer"/>
        </changeMoveSelector>
    </constructionHeuristic>

    <!--
    <localSearch>
        <cartesianProductMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="transmitter">
                    <cacheType>PHASE</cacheType>
                    <selectionOrder>SORTED</selectionOrder>
                    <sorterManner>DECREASING_STRENGTH</sorterManner>
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="receiver">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="processor">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="holoArray">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <swapMoveSelector/>
        </cartesianProductMoveSelector>
    </localSearch>
    -->

    <localSearch>
        <!--
        <localSearchType>LATE_ACCEPTANCE</localSearchType>
        -->

        <!--
        <acceptor>
            <acceptorType>HILL_CLIMBING</acceptorType>
        </acceptor>
        <forager>
            <acceptedCountLimit>5</acceptedCountLimit>
        </forager>
        -->

        <acceptor>
            <entityTabuSize>7</entityTabuSize>
        </acceptor>
        <forager>
            <acceptedCountLimit>1000</acceptedCountLimit>
            <finalistPodiumType>STRATEGIC_OSCILLATION</finalistPodiumType>
        </forager>
        <!-- best
        <acceptor>
            <stepCountingHillClimbingSize>100000</stepCountingHillClimbingSize>
            <entityTabuSize>15</entityTabuSize>
        </acceptor>
        <forager>
            <acceptedCountLimit>1</acceptedCountLimit>
            <pickEarlyType>FIRST_LAST_STEP_SCORE_IMPROVING</pickEarlyType>
        </forager>
-->

<!--
        <acceptor>
            <stepCountingHillClimbingSize>10</stepCountingHillClimbingSize>
            <entityTabuSize>10</entityTabuSize>
        </acceptor>
        <forager>
            <pickEarlyType>FIRST_LAST_STEP_SCORE_IMPROVING</pickEarlyType>
            <acceptedCountLimit>2</acceptedCountLimit>
        </forager>
-->


        <cartesianProductMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="transmitter">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="receiver">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="processor">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <changeMoveSelector>
                <valueSelector variableName="holoArray">
                    <filterClass>com.github.ldoud.modassist.planning.SpeedModSelectionFilter</filterClass>
                </valueSelector>
            </changeMoveSelector>
            <!--
            <cacheType>PHASE</cacheType>
            <selectionOrder>SORTED</selectionOrder>
            <sorterManner>DECREASING_STRENGTH</sorterManner>
            -->
            <cacheType>PHASE</cacheType>
            <selectionOrder>SORTED</selectionOrder>
            <sorterComparatorClass>com.github.ldoud.modassist.planning.ModSetComparator</sorterComparatorClass>
            <filterClass>com.github.ldoud.modassist.planning.SpeedSetMoveChangeFilter</filterClass>
            <!--
            <selectedCountLimit>100</selectedCountLimit>
            -->
        </cartesianProductMoveSelector>
    </localSearch>

</solver>